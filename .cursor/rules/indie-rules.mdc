---
description: 
globs: 
alwaysApply: true
---
### ğŸ§© Reglas para Cursor â€” Stack React + Next.js + Prisma + NestJS (sin tRPC)

**Lenguaje Base:** TypeScript

#### ğŸ“ Estructura de carpetas recomendada

* `app/`: rutas y componentes de pÃ¡ginas (App Router)
* `components/`: UI reutilizable
* `lib/`: utilidades y helpers (validaciones, DB, auth, etc.)
* `server/`: lÃ³gica de backend (API routes, NestJS handlers)
* `types/`: tipos globales
* `styles/`: configuraciÃ³n global de estilos (Tailwind)

---

### âœ… Reglas de Estilo

#### ğŸ”  Tipado

* Habilitar `strict` en `tsconfig.json`
* Evitar `any`; prefiere `unknown`, `z.infer<typeof schema>`, o tipos definidos
* Centralizar tipos compartidos en `types/` o junto al schema correspondiente

#### ğŸ”„ ValidaciÃ³n

* Usa **Zod** para:

  * Validar formularios en frontend
  * Validar inputs en endpoints (`api/`) o servicios NestJS
* Componer esquemas por partes: `schemaBase`, `schemaCreate`, `schemaUpdate`

#### ğŸ“¦ Componentes

* Componentes base UI (ej. `Button`, `Input`) van en `components/ui/`
* Prefiere server components cuando sea posible (menos JS en client)
* Usa `forwardRef` para compatibilidad con shadcn/ui o librerÃ­as externas

#### âš™ï¸ Backend (NestJS + Prisma)

* Usa NestJS como backend independiente o desde `/server/`
* Sigue el patrÃ³n: `Controller â†’ Service â†’ Repository`
* Prisma: crea un `lib/prisma.ts` singleton para evitar mÃºltiples instancias

---

### ğŸ§ª Formularios

* Usa **React Hook Form + Zod**:

  ```ts
  const form = useForm<z.infer<typeof schema>>({
    resolver: zodResolver(schema),
  });
  ```
* Para inputs no controlados, usa `Controller`

---

### ğŸ§¬ AutenticaciÃ³n

* Usa **NextAuth.js** con callbacks personalizados
* AutenticaciÃ³n JWT o basada en sesiÃ³n (segÃºn preferencia)
* ObtÃ©n sesiÃ³n con `useSession()` en client y `getServerSession()` en server

---

### ğŸ¨ Estilos

* Usa **TailwindCSS** como sistema base
* shadcn/ui como librerÃ­a de componentes accesibles y personalizables
* Ãconos con Lucide: [https://lucide.dev](mdc:https:/lucide.dev)
* Anima con Framer Motion (solo client components)

---

### Commands

* Para instalaciones y comandos no uso npm uso pnpm y sus distintos comandos
* Para el caso de comandos de prisma se ejecutaran usando pnpm dlx <comando de prisma>
* Cuando se vaya a ejecutar un comando de prisma en el entorno de desarrollo hay que detener el servidor de desarrollo de next primero antes de ejecutar el comando de prisma

---

### ğŸ”— URLs oficiales de referencia (para la Sidebar de Cursor)

* Next.js: [https://nextjs.org/docs](mdc:https:/nextjs.org/docs)
* React: [https://react.dev](mdc:https:/react.dev)
* TailwindCSS: [https://tailwindcss.com/docs](mdc:https:/tailwindcss.com/docs)
* shadcn/ui: [https://ui.shadcn.com](mdc:https:/ui.shadcn.com)
* Prisma: [https://www.prisma.io/docs](mdc:https:/www.prisma.io/docs)
* NestJS: [https://docs.nestjs.com](mdc:https:/docs.nestjs.com)
* React Hook Form: [https://react-hook-form.com](mdc:https:/react-hook-form.com)
* Zod: [https://zod.dev](mdc:https:/zod.dev)
* NextAuth.js: [https://authjs.dev](mdc:https:/authjs.dev)
* Resend: [https://resend.com/docs](mdc:https:/resend.com/docs)
* React Email: [https://react.email/docs](mdc:https:/react.email/docs)
* Lucide Icons: [https://lucide.dev](mdc:https:/lucide.dev)
* Framer Motion: [https://www.framer.com/motion](mdc:https:/www.framer.com/motion)

